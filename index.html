<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Catálogo de Produtos</title>
</head>
<body>
  <h1>Adicionar Produto</h1>
  <form id="produtoForm" enctype="multipart/form-data">
    <label>Nome:</label><br>
    <input type="text" name="nome" required><br><br>

    <label>Preço:</label><br>
    <input type="number" name="preco" step="0.01" required><br><br>

    <label>Imagem:</label><br>
    <input type="file" name="imagem" accept="image/*"><br><br>

    <button type="submit">Adicionar Produto</button>
  </form>

  <h2>Produtos</h2>
  <ul id="listaProdutos"></ul>

  <script>
    const form = document.getElementById('produtoForm');
    const lista = document.getElementById('listaProdutos');

    // Função para listar produtos
    async function listarProdutos() {
      const res = await fetch('http://localhost:5000/produtos');
      const produtos = await res.json();
      lista.innerHTML = '';
      produtos.forEach(p => {
        const li = document.createElement('li');
    li.innerHTML = `
  ${p.nome} - R$ ${p.preco} <br>
  <img src="${p.imagem 
    ? `http://localhost:5000/uploads/${p.imagem}` 
    : 'https://placehold.co/100x100?text=Sem+Imagem'}" width="100">
`;
;
        lista.appendChild(li);
      });
    }

    // Enviar formulário
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(form);
      await fetch('http://localhost:5000/produtos', {
        method: 'POST',
        body: formData
      });
      form.reset();
      listarProdutos();
    });

    // Listar produtos ao carregar a página
    listarProdutos();
  </script>
</body>
</html>
